<%= form_for @group do |f| %>
    <%= render :partial => 'fragments/error_messages', :locals => {:resource => @group} %>

    <p>
      <%= f.label :name %><br/>
      <%= f.text_field :name, placeholder: "Scrivi un nome dal quale si capisca di cosa si occupa il gruppo e dove si trova.", style: "width: 600px" %>
    </p>

    <p>
      <%= f.label :title_bar %><br/>
      <%= f.text_field :title_bar, placeholder: "Il titolo che apparirà in testa alla pagina del gruppo.", style: "width: 600px" %>
    </p>

    <p>
      <%= f.label :description %><br/>
      <%= f.text_area :description, placeholder: "Questo messaggio apparirà nella prima pagina del gruppo", style: 'width:600px; height:100px;' %>
    </p>
    <p>
      <%= f.label :image_url %><br/>
      <%= f.text_field :image_url, placeholder: "URL dell'immagine del gruppo", style: "width: 600px" %>
    </p>
    <p>
      <%= f.label :facebook_page_url %><br/>
      <%= f.text_field :facebook_page_url, placeholder: "Se il gruppo ha una pagina Facebook, inserisci qui l'indirizzo.", style: "width: 600px" %>
    </p>

    <p>
      <%= f.label :accept_requests %><br/>
      <%= f.radio_button :accept_requests, 'p' %>Portavoce: quando un utente richiede di partecipare al gruppo,
      l'accettazione è consentita solo ai portavoce del gruppo stesso. Una volta che il portavoce avrà accettato la
      richiesta, l'utente sarà a tutti gli effetti un partecipante del gruppo.<br/>
      <!--<%= f.radio_button :accept_requests, 'v', :disabled => "disabled", :title => "Opzione non ancora disponibile" %>Votazione: quando un utente richiede di partecipare al gruppo, tutti gli altri partecipanti devono esprimere il loro parere entro X giorni, al termine dei quali viene determinato se l'utente può entrare o meno.'<br/>
	<%= f.radio_button :accept_requests, 'b', :disabled => "disabled", :title => "Opzione non ancora disponibile" %>Entrambi: avviene la votazione solo a seguito dell'accettazione da parte del portavoce.<br/>
	-->
    </p>

    <p>

      <%= f.label :interest_border_tkn %>
      <%= f.text_field :interest_border_tkn, "data-pre" => ([@group.interest_border].to_json if @group.interest_border) %>
    </p>


    <%if ['new','create'].include? params[:action]%>
        <p>
          <%= f.label :default_role_name %>    <br/>
          <%= f.text_field :default_role_name, placeholder: t('activerecord.attributes.group.default_role_name_placeholder'), style: "width: 400px" %>
          <a href="#" onclick="apri_permessi();return false;">Vuoi cambiare i permessi standard?</a>
        </p>

        <div id="permessi" title="Modfica i permessi standard degli utenti appena iscritti" style="display:none;">
          Queste sono le azioni che gli utenti appena iscritti potranno eseguire all'interno del gruppo: ricorda che
          successivamente potrai sempre modificarli e creare nuovi ruoli!<br/>
          <% GroupAction.all.each do |action| %>
              <%= f.check_box :default_role_actions, {:multiple => true}, action.id, nil %> <%= f.label action.description %>
              <br/>
          <% end %>
        </div>
    <% else %>
        <%= link_to "Nelle Impostazioni Ruoli e permessi potrai modificare le azioni che possono compiere gli iscritti", edit_permissions_group_path(@group) %>
    <% end %>

    <p>
      <%= f.submit button_name, :class => 'buttonStyle' %>
    </p>
<% end %>

<script type="text/javascript">
    $(function () {
        $('#group_description')
                .charCount({
                    counterElement:'div',
                    allowed:2000,
                    warning:100
                });


        $('#group_interest_border_tkn').tokenInput("/interest_borders.json", {
            crossDomain:false,
            prePopulate:$('#group_interest_border_tkn').data("pre"),
            hintText:"Digita alcuni caratteri per cercare un luogo",
            noResultsText:"Nessun luogo trovato",
            searchingText:"Sto cercando...",
            preventDuplicates:true,
            tokenLimit:1
        });

    });


    <%if ['new','create'].include? params[:action]%>
    function apri_permessi() {
        $('#permessi')
        .dialog({width:630,
            height:'auto',
            modal:true,
            resizable:false,
            buttons:{
                "Ok":function () {
                    $(this).dialog("close");
                },
                "Default":function () {
                    $("input[name=group\\[default_role_actions\\]]").attr('checked', false);
                    <%@group.default_role_actions.each do |id|%>
                    $('#group_default_role_actions_<%=id%>').attr('checked', true);
                    <%end%>
                }
            },
            beforeClose: function() {
                $('#permessi').closest('.ui-dialog').detach().appendTo('#new_group');
            }
        });
    }
    <%end%>
</script>