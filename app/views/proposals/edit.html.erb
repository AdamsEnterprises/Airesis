<% @page_title = @proposal.title %>
<h1>Modifica la proposta</h1>

<%= form_for @group ? [@group, @proposal] : @proposal, :validate => true, :remote => @remote do |f| %>

    <h4>Descrivi in maniera esaustiva le problematiche che vuoi affrontare e quali sono gli obiettivi che vuole
      raggiungere la proposta</h4>

    <p>
      <%= f.label :proposal_category_id %><br/>
      <%= select("proposal", "proposal_category_id", ProposalCategory.all.collect { |p| [p.description, p.id] }) %>
    </p>

    <p>
      <%= f.label :problems %> *<br/>
      <%= f.text_area :problems_dirty, :rows => 5, :style => "width:98%;height:280px;", :class => "tinymce" %>
      <%= f.hidden_field :problems %>

    </p>

    <p>
      <%= f.label :objectives %> *<br/>
      <%= f.text_area :objectives_dirty, :rows => 5, :style => "width:98%;height:280px;", :class => "tinymce" %>
      <%= f.hidden_field :objectives %>
    </p>


    <h4>Modifica e aggiorna il testo della proposta!</h4>

    <p>
      <%= f.label :content %><br/>
      <%= f.text_area :content_dirty, :rows => 5, :style => "width:98%;height:280px;", :class => "tinymce" %>
      <%= f.hidden_field :content %>
    </p>

    <p>
      <%= render :partial => 'fragments/error_messages', :locals => {:resource => @proposal} %>
      <%= f.submit "Aggiorna", :class => 'buttonStyle', :onclick => 'return fillCleanFields();' %>
      <a href="#" onclick="fillCleanFields();return false;">aaaaaaaa</a>
    </p>
<% end %>


<script type="text/javascript">
    tinyMCE.init({
        mode:'textareas',
        theme:'advanced',
        theme_advanced_toolbar_location:'top',
        theme_advanced_toolbar_align:'left',
        theme_advanced_buttons1:'bold,italic,underline,separator,undo,redo,separator,bullist,numlist,separator,link,unlink,anchor,image,youtube,separator,ice_toggleshowchanges',
        theme_advanced_buttons2:'',
        theme_advanced_buttons3:'',
        plugins:'iceautolink,media,inlinepopups,youtube,ice',
        theme_advanced_statusbar_location:"none",
        ice:{
            user:{ name:'<%=current_user.fullname%>', id: <%=current_user.id%>},
            preserveOnPaste:'p,a[href],i,em,strong'
        },
        body_class:"CT-hide"
    });
     function fillCleanFields() {
         $('#proposal_problems').val(tinymce.get('proposal_problems_dirty').execCommand('icecleanbody'));
         $('#proposal_objectives').val(tinymce.get('proposal_objectives_dirty').execCommand('icecleanbody'));
         $('#proposal_content').val(tinymce.get('proposal_content_dirty').execCommand('icecleanbody'));
         return true;
     }
</script>