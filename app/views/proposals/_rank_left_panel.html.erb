<script type="text/javascript">
	function hideRankPanel2(panel) {
		$('.voteup',panel).hide();
		$('.votedown',panel).hide();		
		$('.votedup',panel).hide();
		$('.voteddown',panel).hide();		
		$('.loadingup',panel).show();
		$('.loadingdown',panel).show();						
	}	
	$(function() {
		$('.voteup').bind('ajax:beforeSend',function(n,xhr) {
			id = $(this).attr('id');
			num = id.replace('voteup','');
			hideRankPanel2($('.handscontainer'));
		});
		
		$('.votedown').bind('ajax:beforeSend',function(n,xhr) {
			id = $(this).attr('id');
			num = id.replace('votedown','');
			hideRankPanel2($('.handscontainer'));
		});
	});		
</script>
<p class="points">
    <span class="littleText">Score</span> <span class="rightAlign"><%=@proposal.valutations %></span>
</p>
<p class="ranking">
    <span class="littleText">Rank</span> <span class="rightAlign"><%=@proposal.rank %>%</span>
</p>
<%= render :partial => 'proposals/rank_bar', :locals => {:proposal => @proposal} %>
		
<%if (!current_user || (can? :partecipate, @proposal)) %>
		<div class="handscontainer">	
	<%if @my_vote%>
			<% if @my_vote == 1 %>
				<div class="votedup"></div>
			 <%elsif @can_vote_again == 1%>
			 	<%= render :partial => 'proposals/ranking_and_spinner', :locals => {:action => "up"} %>			 
			<%end%>
			<% if @my_vote == 3 %>
				<div class="voteddown"></div>
			<% elsif @can_vote_again == 1%>
				<%= render :partial => 'proposals/ranking_and_spinner', :locals => {:action => "down"} %>				
			<%end%>		
	<%elsif @can_vote_again == 1%>
			<%= render :partial => 'proposals/ranking_and_spinner', :locals => {:action => "up"} %>	
			<%= render :partial => 'proposals/ranking_and_spinner', :locals => {:action => "down"} %>
	<%end %>
		</div>
		<div style="clear: both;"></div>
<%end %>

Categoria: <%= link_to @proposal.category.description, proposals_path(:category => @proposal.category.id)%><br/>
Stato: <%= link_to @proposal.state.description%>
